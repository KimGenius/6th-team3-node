# Migration `20200518053816-init`

This migration has been generated by emiling at 5/18/2020, 5:38:16 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `petmily`.`hotel` (
`address` varchar(191) NOT NULL  ,`address_detail` varchar(191)   ,`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`description` varchar(191) NOT NULL  ,`id` int NOT NULL  AUTO_INCREMENT,`is_neutered_only` boolean   ,`latitude` Decimal(65,30) NOT NULL  ,`longitude` Decimal(65,30) NOT NULL  ,`max_dog_size` int NOT NULL  ,`monitor_available` boolean   ,`name` varchar(191) NOT NULL  ,`page_link` varchar(191) NOT NULL  ,`phone_number` varchar(191) NOT NULL  ,`sat_close_time` datetime(3)   ,`sat_open_time` datetime(3)   ,`sat_price` int   ,`sun_close_time` datetime(3)   ,`sun_open_time` datetime(3)   ,`sun_price` int   ,`updated_at` datetime(3) NOT NULL  ,`week_close_time` datetime(3) NOT NULL  ,`week_open_time` datetime(3) NOT NULL  ,`week_price` int NOT NULL  ,`zipcode` varchar(191)   ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `petmily`.`hotel_monitoring_type` (
`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`hotel_id` int NOT NULL ,`id` int NOT NULL  AUTO_INCREMENT,`name` varchar(191) NOT NULL  ,`updated_at` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `petmily`.`hotel_services` (
`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`hotel_id` int NOT NULL ,`id` int NOT NULL  AUTO_INCREMENT,`name` varchar(191) NOT NULL  ,`updated_at` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `petmily`.`photo` (
`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,`target` ENUM('pet', 'user', 'hotel') NOT NULL  ,`target_id` int NOT NULL  ,`updated_at` datetime(3) NOT NULL  ,`url` varchar(191) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `petmily`.`user` (
`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`email` varchar(191) NOT NULL  ,`id` int NOT NULL  AUTO_INCREMENT,`name` varchar(191) NOT NULL  ,`password` varchar(191) NOT NULL  ,`phone_number` varchar(191) NOT NULL  ,`updated_at` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `petmily`.`pet` (
`breed` varchar(191) NOT NULL  ,`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`gender` ENUM('수컷', '암컷') NOT NULL  ,`id` int NOT NULL  AUTO_INCREMENT,`is_neutered` boolean NOT NULL  ,`name` varchar(191) NOT NULL  ,`register_num` varchar(191) NOT NULL  ,`rfid_cd` varchar(191) NOT NULL  ,`updated_at` datetime(3) NOT NULL  ,`user_id` int NOT NULL ,`year` int NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `petmily`.`_HotelToUser` (
`A` int NOT NULL ,`B` int NOT NULL 
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `hotel.name` ON `petmily`.`hotel`(`name`)

CREATE UNIQUE INDEX `hotel_monitoring_type.name` ON `petmily`.`hotel_monitoring_type`(`name`)

CREATE UNIQUE INDEX `hotel_services.name` ON `petmily`.`hotel_services`(`name`)

CREATE UNIQUE INDEX `user.name` ON `petmily`.`user`(`name`)

CREATE UNIQUE INDEX `_HotelToUser_AB_unique` ON `petmily`.`_HotelToUser`(`A`,`B`)

CREATE  INDEX `_HotelToUser_B_index` ON `petmily`.`_HotelToUser`(`B`)

ALTER TABLE `petmily`.`hotel_monitoring_type` ADD FOREIGN KEY (`hotel_id`) REFERENCES `petmily`.`hotel`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `petmily`.`hotel_services` ADD FOREIGN KEY (`hotel_id`) REFERENCES `petmily`.`hotel`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `petmily`.`pet` ADD FOREIGN KEY (`user_id`) REFERENCES `petmily`.`user`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `petmily`.`_HotelToUser` ADD FOREIGN KEY (`A`) REFERENCES `petmily`.`hotel`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `petmily`.`_HotelToUser` ADD FOREIGN KEY (`B`) REFERENCES `petmily`.`user`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200518053816-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,120 @@
+datasource mysql {
+  url      = env("DATABASE_URL")
+  provider = "mysql"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+// TODO: Review, Reservation,
+model Hotel {
+  id               Int          @default(autoincrement()) @id
+  createdAt        DateTime     @default(now()) @map("created_at")
+  updatedAt        DateTime     @map("updated_at") @updatedAt
+  name             String       @unique
+  description      String
+  address          String
+  addressDetail    String?      @map("address_detail")
+  zipcode          String?
+  latitude         Float
+  longitude        Float
+  weekOpenTime     DateTime     @map("week_open_time")
+  weekCloseTime    DateTime     @map("week_close_time")
+  satOpenTime      DateTime?    @map("sat_open_time")
+  satCloseTime     DateTime?    @map("sat_close_time")
+  sunOpenTime      DateTime?    @map("sun_open_time")
+  sunCloseTime     DateTime?    @map("sun_close_time")
+  weekPrice        Int          @map("week_price")
+  satPrice         Int?         @map("sat_price")
+  sunPrice         Int?         @map("sun_price")
+  phoneNumber      String       @map("phone_number")
+  monitorAvailable Boolean?     @map("monitor_available")
+  isNeuteredOnly   Boolean?     @map("is_neutered_only")
+  maxDogSize       Int          @map("max_dog_size")
+  pageLink         String       @map("page_link")
+  monitorings      Monitoring[]
+  services         Service[]
+  customers        User[]       @relation(references: [id])
+
+  @@map("hotel")
+}
+
+model Monitoring {
+  id        Int      @default(autoincrement()) @id
+  hotelId   Int      @map("hotel_id")
+  createdAt DateTime @default(now()) @map("created_at")
+  updatedAt DateTime @map("updated_at") @updatedAt
+  name      String   @unique
+  hotel     Hotel    @relation(fields: [hotelId], references: [id])
+
+  @@map("hotel_monitoring_type")
+}
+
+model Service {
+  id        Int      @default(autoincrement()) @id
+  hotelId   Int      @map("hotel_id")
+  createdAt DateTime @default(now()) @map("created_at")
+  updatedAt DateTime @map("updated_at") @updatedAt
+  name      String   @unique
+  hotel     Hotel    @relation(fields: [hotelId], references: [id])
+
+  @@map("hotel_services")
+}
+
+model Photo {
+  id        Int      @default(autoincrement()) @id
+  createdAt DateTime @default(now()) @map("created_at")
+  updatedAt DateTime @map("updated_at") @updatedAt
+  url       String
+  target    Target
+  targetId  Int      @map("target_id")
+
+  @@map("photo")
+}
+
+model User {
+  id             Int      @default(autoincrement()) @id
+  createdAt      DateTime @default(now()) @map("created_at")
+  updatedAt      DateTime @map("updated_at") @updatedAt
+  name           String   @unique
+  email          String
+  password       String
+  phoneNumber    String   @map("phone_number")
+  pets           Pet[]
+  favoriteHotels Hotel[]  @relation(references: [id])
+
+  @@map("user")
+}
+
+model Pet {
+  id          Int      @default(autoincrement()) @id
+  userId      Int      @map("user_id")
+  createdAt   DateTime @default(now()) @map("created_at")
+  updatedAt   DateTime @map("updated_at") @updatedAt
+  name        String
+  year        Int
+  registerNum String   @map("register_num")
+  rfidCd      String   @map("rfid_cd")
+  breed       String
+  isNeutered  Boolean  @map("is_neutered")
+  gender      Gender
+  owner       User     @relation(fields: [userId], references: [id])
+
+  @@map("pet")
+}
+
+enum Gender {
+  MALE @map("수컷")
+  FEMAIL @map("암컷")
+
+   @@map("gender")
+}
+
+enum Target {
+  PET @map("pet")
+  USER @map("user")
+  HOTEL @map("hotel")
+
+   @@map("target")
+}
```


