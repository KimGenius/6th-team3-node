# Migration `20200622144508`

This migration has been generated by boorim98 at 6/22/2020, 2:45:08 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `petmily`.`reservation` (
`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`end_date` datetime(3)   ,`hotel_id` int NOT NULL ,`id` int NOT NULL  AUTO_INCREMENT,`pet_id` int NOT NULL ,`pick_up_time` varchar(191)   ,`request` varchar(191)   ,`start_date` datetime(3)   ,`updated_at` datetime(3)   ,`user_id` int NOT NULL ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `petmily`.`reservation_payment` (
`created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,`reservation_id` int NOT NULL ,`updated_at` datetime(3)   ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `reservation_payment_reservation_id` ON `petmily`.`reservation_payment`(`reservation_id`)

ALTER TABLE `petmily`.`reservation` ADD FOREIGN KEY (`user_id`) REFERENCES `petmily`.`user`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `petmily`.`reservation` ADD FOREIGN KEY (`hotel_id`) REFERENCES `petmily`.`hotel`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `petmily`.`reservation` ADD FOREIGN KEY (`pet_id`) REFERENCES `petmily`.`pet`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `petmily`.`reservation_payment` ADD FOREIGN KEY (`reservation_id`) REFERENCES `petmily`.`reservation`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200611104706..20200622144508
--- datamodel.dml
+++ datamodel.dml
@@ -1,41 +1,42 @@
 datasource mysql {
-  url = "***"
+  url      = env("DATABASE_URL")
   provider = "mysql"
 }
 generator client {
   provider = "prisma-client-js"
 }
 model Hotel {
-  id               Int          @default(autoincrement()) @id
-  createdAt        DateTime     @default(now()) @map("created_at")
-  updatedAt        DateTime?    @map("updated_at") @updatedAt
+  id               Int           @default(autoincrement()) @id
+  createdAt        DateTime      @default(now()) @map("created_at")
+  updatedAt        DateTime?     @map("updated_at") @updatedAt
   name             String?
   description      String?
   address          String?
-  addressDetail    String?      @map("address_detail")
+  addressDetail    String?       @map("address_detail")
   zipcode          String?
   latitude         Float?
   longitude        Float?
-  weekOpenTime     String?      @map("week_open_time")
-  weekCloseTime    String?      @map("week_close_time")
-  satOpenTime      String?      @map("sat_open_time")
-  satCloseTime     String?      @map("sat_close_time")
-  sunOpenTime      String?      @map("sun_open_time")
-  sunCloseTime     String?      @map("sun_close_time")
-  phoneNumber      String?      @map("phone_number")
-  monitorAvailable Boolean?     @map("monitor_available")
-  isNeuteredOnly   Boolean?     @map("is_neutered_only")
-  maxDogSize       Int?         @map("max_dog_size")
-  pageLink         String?      @map("page_link")
-  mediumCriteria   Int?         @map("medium_criteria") //소형견과 중형견을 나누는 기준
-  largeCriteria    Int?         @map("largs_criteria") //중형견과 대형견을 나누는 기준
+  weekOpenTime     String?       @map("week_open_time")
+  weekCloseTime    String?       @map("week_close_time")
+  satOpenTime      String?       @map("sat_open_time")
+  satCloseTime     String?       @map("sat_close_time")
+  sunOpenTime      String?       @map("sun_open_time")
+  sunCloseTime     String?       @map("sun_close_time")
+  phoneNumber      String?       @map("phone_number")
+  monitorAvailable Boolean?      @map("monitor_available")
+  isNeuteredOnly   Boolean?      @map("is_neutered_only")
+  maxDogSize       Int?          @map("max_dog_size")
+  pageLink         String?       @map("page_link")
+  mediumCriteria   Int?          @map("medium_criteria") //소형견과 중형견을 나누는 기준
+  largeCriteria    Int?          @map("largs_criteria") //중형견과 대형견을 나누는 기준
   monitorings      Monitoring[]
   services         Service[]
   prices           Price[]
-  customers        User[]       @relation(references: [id])
+  reservations     Reservation[]
+  customers        User[]        @relation(references: [id])
   @@map("hotel")
 }
@@ -86,42 +87,74 @@
   @@map("photo")
 }
 model User {
-  id             Int       @default(autoincrement()) @id
-  createdAt      DateTime  @default(now()) @map("created_at")
-  updatedAt      DateTime? @map("updated_at") @updatedAt
-  name           String?   @unique
-  email          String    @unique
+  id             Int           @default(autoincrement()) @id
+  createdAt      DateTime      @default(now()) @map("created_at")
+  updatedAt      DateTime?     @map("updated_at") @updatedAt
+  name           String?       @unique
+  email          String        @unique
   password       String?
   provider       Provider?
-  accessToken    String?   @map("access_token")
-  refreshToken   String?   @map("refresh_token")
-  phoneNumber    String?   @map("phone_number")
+  accessToken    String?       @map("access_token")
+  refreshToken   String?       @map("refresh_token")
+  phoneNumber    String?       @map("phone_number")
   pets           Pet[]
-  favoriteHotels Hotel[]   @relation(references: [id])
+  favoriteHotels Hotel[]       @relation(references: [id])
+  Reservation    Reservation[]
   @@map("user")
+
 }
 model Pet {
-  id          Int       @default(autoincrement()) @id
-  userId      Int?      @map("user_id")
-  createdAt   DateTime  @default(now()) @map("created_at")
-  updatedAt   DateTime? @map("updated_at") @updatedAt
-  name        String?
-  year        Int?
-  weight      Int?
-  registerNum String?   @map("register_num")
-  rfidCode    String?   @map("rfid_cd")
-  breed       String?
-  isNeutered  Boolean?  @map("is_neutered")
-  gender      Gender?
-  owner       User?     @relation(fields: [userId], references: [id])
+  id           Int           @default(autoincrement()) @id
+  userId       Int?          @map("user_id")
+  createdAt    DateTime      @default(now()) @map("created_at")
+  updatedAt    DateTime?     @map("updated_at") @updatedAt
+  name         String?
+  year         Int?
+  weight       Int?
+  registerNum  String?       @map("register_num")
+  rfidCode     String?       @map("rfid_cd")
+  breed        String?
+  isNeutered   Boolean?      @map("is_neutered")
+  gender       Gender?
+  owner        User?         @relation(fields: [userId], references: [id])
+  reservations Reservation[]
   @@map("pet")
 }
+model Reservation {
+  id         Int       @default(autoincrement()) @id
+  userId     Int       @map("user_id")
+  hotelId    Int       @map("hotel_id")
+  petId      Int       @map("pet_id")
+  createdAt  DateTime  @default(now()) @map("created_at")
+  updatedAt  DateTime? @map("updated_at") @updatedAt
+  startDate  DateTime? @map("start_date")
+  endDate    DateTime? @map("end_date")
+  pickupTime String?   @map("pick_up_time")
+  request    String?
+  payment    Payment
+  User       User      @relation(fields: [userId], references: [id])
+  Hotel      Hotel     @relation(fields: [hotelId], references: [id])
+  Pet        Pet       @relation(fields: [petId], references: [id])
+
+  @@map("reservation")
+}
+
+model Payment {
+  id            Int         @default(autoincrement()) @id
+  reservationId Int         @map("reservation_id")
+  createdAt     DateTime    @default(now()) @map("created_at")
+  updatedAt     DateTime?   @map("updated_at") @updatedAt
+  reservation   Reservation @relation(fields: [reservationId], references: [id])
+
+  @@map("reservation_payment")
+}
+
 enum Gender {
   MALE    @map("수컷")
   FEMAIL  @map("암컷")
```


